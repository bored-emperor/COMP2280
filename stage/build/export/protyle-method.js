(()=>{var Ne=(A,E)=>()=>(E||A((E={exports:{}}).exports,E),E.exports);var we=Ne((D,H)=>{(function(E,L){typeof D=="object"&&typeof H=="object"?H.exports=L():typeof define=="function"&&define.amd?define([],L):typeof D=="object"?D.Protyle=L():E.Protyle=L()})(self,()=>(()=>{"use strict";var A={};A.d=(e,t)=>{for(var s in t)A.o(t,s)&&!A.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},A.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var E={};A.d(E,{default:()=>Se});var L=(e,t,s)=>new Promise((n,a)=>{var l=u=>{try{o(s.next(u))}catch(d){a(d)}},r=u=>{try{o(s.throw(u))}catch(d){a(d)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(l,r);o((s=s.apply(e,t)).next())});const Oe=(e,t)=>L(void 0,null,function*(){if(document.getElementById(t))return!1;const s=new XMLHttpRequest;s.open("GET",e,!1),s.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),s.send("");const n=document.createElement("script");n.type="text/javascript",n.text=s.responseText,n.id=t,document.head.appendChild(n),typeof Lute=="undefined"&&window.location.reload()}),g=(e,t)=>new Promise(s=>{if(document.getElementById(t))return s(!1),!1;const n=document.createElement("script");n.src=e,n.async=!0,document.head.appendChild(n),n.onload=()=>{if(document.getElementById(t))return n.remove(),s(!1),!1;n.id=t,s(!0)}}),J=new Set(["docker","ios","android","harmony"]),Q=()=>J.has(window.siyuan.config.system.container),G=()=>!!document.getElementById("sidebar"),ve=()=>Q()?window.siyuan.config.system.container:window.siyuan.config.system.os,Ie=()=>window.navigator.userAgent.startsWith("SiYuan/")?"mobile":"browser-mobile",Re=()=>!document.getElementById("toolbar"),Me=()=>"ontouchstart"in window&&navigator.maxTouchPoints>1,ke=(e,t)=>e.length===t.length&&e.every(s=>t.includes(s)),xe=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,De=(e,t=window.location.search)=>{const s=t.substring(t.indexOf("?")),n=s.indexOf("#");return new URLSearchParams(s.substring(0,n>=0?n:void 0)).get(e)},Ue=()=>!0,Pe=e=>/^\(\(\d{14}-\w{7} '.*'\)\)$/.test(e),Be=e=>/^<<assets\/.+\/\d{14}-\w{7} ".+">>$/.test(e),He=e=>/^[a-z][\-0-9a-z]*$/.test(e),U=e=>Function(`"use strict";return (${e})`)(),ee=(e,t)=>{if(e===t||typeof e=="number"&&isNaN(e)&&typeof t=="number"&&isNaN(t))return!0;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(!e||!t||typeof e!="object"&&typeof t!="object")return e===t;if(e.prototype!==t.prototype)return!1;const s=Object.keys(e);return s.length!==Object.keys(t).length?!1:s.every(n=>ee(e[n],t[n]))},Ge=e=>{if(!e)return"";const t=e.match(/^(.*) \((\d+)\)$/);return t?e=`${t[1]} (${parseInt(t[2])+1})`:e=`${e} (1)`,e},te="3.5.5",se="production",h=navigator.platform.toUpperCase().indexOf("MAC")>-1?"\u2303":"\u2325",ie=()=>{const e={};for(let t=1;t<=32;t++)e[t+111]="F"+t;return e},i=class{};i.SIYUAN_VERSION=te,i.NODE_ENV=se,i.SIYUAN_APPID=Math.random().toString(36).substring(8),i.ASSETS_ADDRESS="https://assets.b3logfile.com/siyuan/",i.PROTYLE_CDN="/stage/protyle",i.UPLOAD_ADDRESS="/upload",i.SERVICE_WORKER_PATH="/service-worker.js",i.SIYUAN_DROP_FILE="application/siyuan-file",i.SIYUAN_DROP_GUTTER="application/siyuan-gutter",i.SIYUAN_DROP_TAB="application/siyuan-tab",i.SIYUAN_DROP_EDITOR="application/siyuan-editor",i.SIYUAN_CMD="siyuan-cmd",i.SIYUAN_GET="siyuan-get",i.SIYUAN_EVENT="siyuan-event",i.SIYUAN_CONFIG_TRAY="siyuan-config-tray",i.SIYUAN_QUIT="siyuan-quit",i.SIYUAN_HOTKEY="siyuan-hotkey",i.SIYUAN_INIT="siyuan-init",i.SIYUAN_SEND_WINDOWS="siyuan-send-windows",i.SIYUAN_SAVE_CLOSE="siyuan-save-close",i.SIYUAN_AUTO_LAUNCH="siyuan-auto-launch",i.SIYUAN_OPEN_WORKSPACE="siyuan-open-workspace",i.SIYUAN_OPEN_URL="siyuan-open-url",i.SIYUAN_OPEN_WINDOW="siyuan-open-window",i.SIYUAN_OPEN_FILE="siyuan-open-file",i.SIYUAN_EXPORT_PDF="siyuan-export-pdf",i.SIYUAN_EXPORT_NEWWINDOW="siyuan-export-newwindow",i.SIYUAN_CONTEXT_MENU="siyuan-context-menu",i.SIYUAN_SHOW_WINDOW="siyuan-show-window",i.CUSTOM_SY_READONLY="custom-sy-readonly",i.CUSTOM_SY_FULLWIDTH="custom-sy-fullwidth",i.CUSTOM_SY_AV_VIEW="custom-sy-av-view",i.CUSTOM_REMINDER_WECHAT="custom-reminder-wechat",i.CUSTOM_RIFF_DECKS="custom-riff-decks",i.SIZE_DATABASE_MAZ_SIZE=102400,i.SIZE_UPLOAD_TIP_SIZE=268435456,i.SIZE_SCROLL_TB=24,i.SIZE_SCROLL_STEP=256,i.SIZE_LINK_TEXT_MAX=64,i.SIZE_TOOLBAR_HEIGHT=G()?0:32,i.SIZE_GET_MAX=102400,i.SIZE_UNDO=64,i.SIZE_TITLE=512,i.SIZE_EDITOR_WIDTH=760,i.SIZE_ZOOM=[{zoom:.67,position:{x:0,y:2}},{zoom:.75,position:{x:1,y:4}},{zoom:.8,position:{x:2,y:4}},{zoom:.9,position:{x:5,y:6}},{zoom:1,position:{x:8,y:8}},{zoom:1.1,position:{x:12,y:9}},{zoom:1.25,position:{x:18,y:12}},{zoom:1.5,position:{x:27,y:16}},{zoom:1.75,position:{x:36,y:20}},{zoom:2,position:{x:45,y:23}},{zoom:2.5,position:{x:63,y:31}},{zoom:3,position:{x:80,y:39}}],i.CB_MOVE_NOLIST="cb-move-nolist",i.CB_MOUNT_REMOVE="cb-mount-remove",i.CB_GET_APPEND="cb-get-append",i.CB_GET_BEFORE="cb-get-before",i.CB_GET_UNCHANGEID="cb-get-unchangeid",i.CB_GET_HL="cb-get-hl",i.CB_GET_FOCUS="cb-get-focus",i.CB_GET_FOCUSFIRST="cb-get-focusfirst",i.CB_GET_SETID="cb-get-setid",i.CB_GET_OUTLINE="cb-get-outline",i.CB_GET_ALL="cb-get-all",i.CB_GET_BACKLINK="cb-get-backlink",i.CB_GET_UNUNDO="cb-get-unundo",i.CB_GET_SCROLL="cb-get-scroll",i.CB_GET_SEARCH="cb-get-search",i.CB_GET_CONTEXT="cb-get-context",i.CB_GET_ROOTSCROLL="cb-get-rootscroll",i.CB_GET_HTML="cb-get-html",i.CB_GET_HISTORY="cb-get-history",i.CB_GET_OPENNEW="cb-get-opennew",i.LOCAL_ZOOM="local-zoom",i.LOCAL_SEARCHDATA="local-searchdata",i.LOCAL_SEARCHKEYS="local-searchkeys",i.LOCAL_SEARCHASSET="local-searchasset",i.LOCAL_SEARCHUNREF="local-searchunref",i.LOCAL_DOCINFO="local-docinfo",i.LOCAL_DAILYNOTEID="local-dailynoteid",i.LOCAL_HISTORY="local-history",i.LOCAL_CODELANG="local-codelang",i.LOCAL_FONTSTYLES="local-fontstyles",i.LOCAL_EXPORTPDF="local-exportpdf",i.LOCAL_EXPORTWORD="local-exportword",i.LOCAL_EXPORTIMG="local-exportimg",i.LOCAL_BAZAAR="local-bazaar",i.LOCAL_PDFTHEME="local-pdftheme",i.LOCAL_LAYOUTS="local-layouts",i.LOCAL_AI="local-ai",i.LOCAL_PLUGINTOPUNPIN="local-plugintopunpin",i.LOCAL_FLASHCARD="local-flashcard",i.LOCAL_FILEPOSITION="local-fileposition",i.LOCAL_FILESPATHS="local-filespaths",i.LOCAL_DIALOGPOSITION="local-dialogposition",i.LOCAL_SESSION_FIRSTLOAD="local-session-firstload",i.LOCAL_OUTLINE="local-outline",i.LOCAL_PLUGIN_DOCKS="local-plugin-docks",i.LOCAL_IMAGES="local-images",i.LOCAL_EMOJIS="local-emojis",i.LOCAL_MOVE_PATH="local-move-path",i.LOCAL_RECENT_DOCS="local-recent-docs",i.LOCAL_CLOSED_TABS="local-closed-tabs",i.DIALOG_CONFIRM="dialog-confirm",i.DIALOG_OPENCARD="dialog-opencard",i.DIALOG_MAKECARD="dialog-makecard",i.DIALOG_VIEWCARDS="dialog-viewcards",i.DIALOG_DIALYNOTE="dialog-dialynote",i.DIALOG_RECENTDOCS="dialog-recentdocs",i.DIALOG_SWITCHTAB="dialog-switchtab",i.DIALOG_SEARCH="dialog-search",i.DIALOG_REPLACE="dialog-replace",i.DIALOG_GLOBALSEARCH="dialog-globalsearch",i.DIALOG_HISTORYCOMPARE="dialog-historycompare",i.DIALOG_ACCESSAUTHCODE="dialog-accessauthcode",i.DIALOG_AICUSTOMACTION="dialog-aicustomaction",i.DIALOG_AIUPDATECUSTOMACTION="dialog-aiupdatecustomaction",i.DIALOG_BACKGROUNDLINK="dialog-backgroundlink",i.DIALOG_BACKGROUNDRANDOM="dialog-backgroundrandom",i.DIALOG_CHANGELOG="dialog-changelog",i.DIALOG_COMMANDPANEL="dialog-commandpanel",i.DIALOG_DEACTIVATEUSER="dialog-deactivateuser",i.DIALOG_EMOJIS="dialog-emojis",i.DIALOG_EXPORTIMAGE="dialog-exportimage",i.DIALOG_EXPORTTEMPLATE="dialog-exporttemplate",i.DIALOG_EXPORTWORD="dialog-exportword",i.DIALOG_HISTORY="dialog-history",i.DIALOG_HISTORYDOC="dialog-historydoc",i.DIALOG_MOVEPATHTO="dialog-movepathto",i.DIALOG_RENAME="dialog-rename",i.DIALOG_RENAMEASSETS="dialog-renameassets",i.DIALOG_RENAMEBOOKMARK="dialog-renamebookmark",i.DIALOG_RENAMETAG="dialog-renametag",i.DIALOG_REPLACETYPE="dialog-replacetype",i.DIALOG_SAVECRITERION="dialog-savecriterion",i.DIALOG_SEARCHTYPE="dialog-searchtype",i.DIALOG_SEARCHASSETSTYPE="dialog-searchassetstype",i.DIALOG_SETTING="dialog-setting",i.DIALOG_SNAPSHOTTAG="dialog-snapshottag",i.DIALOG_SNAPSHOTMEMO="dialog-snapshotmemo",i.DIALOG_SNIPPETS="dialog-snippets",i.DIALOG_SYNCADDCLOUDDIR="dialog-syncaddclouddir",i.DIALOG_SYNCCHOOSEDIR="dialog-syncchoosedir",i.DIALOG_SYNCCHOOSEDIRECTION="dialog-syncchoosedirection",i.DIALOG_TRANSFERBLOCKREF="dialog-transferblockref",i.DIALOG_WECHATREMINDER="dialog-wechatreminder",i.DIALOG_PASSWORD="dialog-password",i.DIALOG_SETPASSWORD="dialog-setpassword",i.DIALOG_BOOTSYNCFAILED="dialog-bootsyncfailed",i.DIALOG_KERNELFAULT="dialog-kernelfault",i.DIALOG_STATEEXCEPTED="dialog-stateexcepted",i.DIALOG_ATTR="dialog-attr",i.DIALOG_SETCUSTOMATTR="dialog-setcustomattr",i.DIALOG_CREATENOTEBOOK="dialog-createnotebook",i.DIALOG_NOTEBOOKCONF="dialog-notebookconf",i.DIALOG_CREATEWORKSPACE="dialog-createworkspace",i.DIALOG_OPENWORKSPACE="dialog-openworkspace",i.DIALOG_SAVEWORKSPACE="dialog-saveworkspace",i.MENU_BAR_WORKSPACE="barWorkspace",i.MENU_BAR_PLUGIN="topBarPlugin",i.MENU_BAR_ZOOM="barZoom",i.MENU_BAR_MODE="barmode",i.MENU_BAR_MORE="barmore",i.MENU_STATUS_HELP="statusHelp",i.MENU_STATUS_BACKGROUND_TASK="statusBackgroundTask",i.MENU_DOCK_MOBILE="dockMobileMenu",i.MENU_BLOCK_SINGLE="block-single",i.MENU_BLOCK_MULTI="block-multi",i.MENU_TITLE="titleMenu",i.MENU_FROM_TITLE_PROTYLE="title-protyle",i.MENU_FROM_TITLE_BREADCRUMB="title-breadcrumb",i.MENU_BREADCRUMB_MORE="breadcrumbMore",i.MENU_BREADCRUMB_MOBILE_PATH="breadcrumb-mobile-path",i.MENU_DOC_TREE_MORE="docTreeMore",i.MENU_FROM_DOC_TREE_MORE_NOTEBOOK="tree-notebook",i.MENU_FROM_DOC_TREE_MORE_DOC="tree-doc",i.MENU_FROM_DOC_TREE_MORE_ITEMS="tree-items",i.MENU_TAG="tagMenu",i.MENU_BOOKMARK="bookmarkMenu",i.MENU_OUTLINE_CONTEXT="outline-context",i.MENU_OUTLINE_EXPAND_LEVEL="outline-expand-level",i.MENU_AV_VIEW="av-view",i.MENU_AV_HEADER_CELL="av-header-cell",i.MENU_AV_HEADER_ADD="av-header-add",i.MENU_AV_ADD_FILTER="av-add-filter",i.MENU_AV_ADD_SORT="av-add-sort",i.MENU_AV_COL_OPTION="av-col-option",i.MENU_AV_COL_FORMAT_NUMBER="av-col-format-number",i.MENU_AV_GROUP_DATE="avGroupDate",i.MENU_AV_GROUP_SORT="avGroupSort",i.MENU_AV_ASSET_EDIT="av-asset-edit",i.MENU_AV_CALC="av-calc",i.MENU_AV_PAGE_SIZE="av-page-size",i.MENU_SEARCH_MORE="searchMore",i.MENU_SEARCH_METHOD="searchMethod",i.MENU_SEARCH_ASSET_MORE="searchAssetMore",i.MENU_SEARCH_ASSET_METHOD="searchAssetMethod",i.MENU_SEARCH_UNREF_MORE="searchUnRefMore",i.MENU_SEARCH_HISTORY="search-history",i.MENU_SEARCH_REPLACE_HISTORY="search-replace-history",i.MENU_SEARCH_ASSET_HISTORY="search-asset-history",i.MENU_MOVE_PATH_HISTORY="move-path-history",i.MENU_CALLOUT_SELECT="callout-select",i.MENU_BACKGROUND_ASSET="background-asset",i.MENU_AI="ai",i.MENU_TAB="tab",i.MENU_TAB_LIST="tabList",i.MENU_INLINE_CONTEXT="inline-context",i.MENU_INLINE_IMG="inline-img",i.MENU_INLINE_FILE_ANNOTATION_REF="inline-file-annotation-ref",i.MENU_INLINE_REF="inline-block-ref",i.MENU_INLINE_A="inline-a",i.MENU_INLINE_TAG="inline-tag",i.MENU_INLINE_MATH="inline-math",i.TIMEOUT_OPENDIALOG=50,i.TIMEOUT_DBLCLICK=190,i.TIMEOUT_RESIZE=200,i.TIMEOUT_INPUT=256,i.TIMEOUT_LOAD=300,i.TIMEOUT_TRANSITION=300,i.TIMEOUT_COUNT=1e3,i.HELP_PATH={ar_SA:"20210808180117-6v0mkxr",de_DE:"20210808180117-6v0mkxr",en_US:"20210808180117-6v0mkxr",es_ES:"20210808180117-6v0mkxr",fr_FR:"20210808180117-6v0mkxr",he_IL:"20210808180117-6v0mkxr",it_IT:"20210808180117-6v0mkxr",ja_JP:"20240530133126-axarxgx",ko_KR:"20210808180117-6v0mkxr",pl_PL:"20210808180117-6v0mkxr",pt_BR:"20210808180117-6v0mkxr",ru_RU:"20210808180117-6v0mkxr",tr_TR:"20210808180117-6v0mkxr",zh_CHT:"20211226090932-5lcq56f",zh_CN:"20210808180117-czj9bvb"},i.QUICK_DECK_ID="20230218211946-2kw8jgx",i.KEYCODELIST=Object.assign(ie(),{8:"\u232B",9:"\u21E5",13:"\u21A9",16:"\u21E7",17:"\u2303",18:"\u2325",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"\u2190",38:"\u2191",39:"\u2192",40:"\u2193",44:"PrintScreen",45:"Insert",46:"\u2326",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"\u2318",92:"\u2318",93:"ContextMenu",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",182:"MyComputer",183:"MyCalculator",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}),i.SIYUAN_KEYMAP={general:{mainMenu:{default:"\u2325\\",custom:"\u2325\\"},commandPanel:{default:"\u2325\u21E7P",custom:"\u2325\u21E7P"},editReadonly:{default:"\u21E7\u2318G",custom:"\u21E7\u2318G"},syncNow:{default:"F9",custom:"F9"},enterBack:{default:"\u2325\u2190",custom:"\u2325\u2190"},enter:{default:"\u2325\u2192",custom:"\u2325\u2192"},goForward:{default:"\u2318]",custom:"\u2318]"},goBack:{default:"\u2318[",custom:"\u2318["},newFile:{default:"\u2318N",custom:"\u2318N"},search:{default:"\u2318F",custom:"\u2318F"},globalSearch:{default:"\u2318P",custom:"\u2318P"},stickSearch:{default:"\u21E7\u2318F",custom:"\u21E7\u2318F"},replace:{default:"\u2318R",custom:"\u2318R"},closeTab:{default:"\u2318W",custom:"\u2318W"},fileTree:{default:h+"1",custom:h+"1"},outline:{default:h+"2",custom:h+"2"},bookmark:{default:h+"3",custom:h+"3"},tag:{default:h+"4",custom:h+"4"},dailyNote:{default:h+"5",custom:h+"5"},inbox:{default:h+"6",custom:h+"6"},backlinks:{default:h+"7",custom:h+"7"},graphView:{default:h+"8",custom:h+"8"},globalGraph:{default:h+"9",custom:h+"9"},riffCard:{default:h+"0",custom:h+"0"},config:{default:"\u2325P",custom:"\u2325P"},dataHistory:{default:"\u2325H",custom:"\u2325H"},toggleWin:{default:"\u2325M",custom:"\u2325M"},lockScreen:{default:"\u2325N",custom:"\u2325N"},recentDocs:{default:"\u2318E",custom:"\u2318E"},goToTab1:{default:"\u23181",custom:"\u23181"},goToTab2:{default:"\u23182",custom:"\u23182"},goToTab3:{default:"\u23183",custom:"\u23183"},goToTab4:{default:"\u23184",custom:"\u23184"},goToTab5:{default:"\u23185",custom:"\u23185"},goToTab6:{default:"\u23186",custom:"\u23186"},goToTab7:{default:"\u23187",custom:"\u23187"},goToTab8:{default:"\u23188",custom:"\u23188"},goToTab9:{default:"\u23189",custom:"\u23189"},goToTabNext:{default:"\u21E7\u2318]",custom:"\u21E7\u2318]"},goToTabPrev:{default:"\u21E7\u2318[",custom:"\u21E7\u2318["},goToEditTabNext:{default:"\u2303\u21E5",custom:"\u2303\u21E5"},goToEditTabPrev:{default:"\u2303\u21E7\u21E5",custom:"\u2303\u21E7\u21E5"},recentClosed:{default:"\u21E7\u2318T",custom:"\u21E7\u2318T"},move:{default:"",custom:""},selectOpen1:{default:"",custom:""},toggleDock:{default:"",custom:""},splitLR:{default:"",custom:""},splitMoveR:{default:"",custom:""},splitTB:{default:"",custom:""},splitMoveB:{default:"",custom:""},closeOthers:{default:"",custom:""},closeAll:{default:"",custom:""},closeUnmodified:{default:"",custom:""},closeLeft:{default:"",custom:""},closeRight:{default:"",custom:""},tabToWindow:{default:"",custom:""},addToDatabase:{default:"",custom:""},unsplit:{default:"",custom:""},unsplitAll:{default:"",custom:""}},editor:{general:{duplicate:{default:"\u2318D",custom:"\u2318D"},expandDown:{default:"\u2325\u21E7\u2193",custom:"\u2325\u21E7\u2193"},expandUp:{default:"\u2325\u21E7\u2191",custom:"\u2325\u21E7\u2191"},expand:{default:"\u2318\u2193",custom:"\u2318\u2193"},collapse:{default:"\u2318\u2191",custom:"\u2318\u2191"},insertBottom:{default:"\u2325\u2318.",custom:"\u2325\u2318."},refTab:{default:"\u21E7\u2318.",custom:"\u21E7\u2318."},openBy:{default:"\u2325,",custom:"\u2325,"},insertRight:{default:"\u2325.",custom:"\u2325."},attr:{default:"\u2325\u2318A",custom:"\u2325\u2318A"},quickMakeCard:{default:"\u2325\u2318F",custom:"\u2325\u2318F"},refresh:{default:"F5",custom:"F5"},copyBlockRef:{default:"\u21E7\u2318C",custom:"\u21E7\u2318C"},copyProtocol:{default:"\u21E7\u2318H",custom:"\u21E7\u2318H"},copyBlockEmbed:{default:"\u21E7\u2318E",custom:"\u21E7\u2318E"},copyHPath:{default:"\u21E7\u2318P",custom:"\u21E7\u2318P"},undo:{default:"\u2318Z",custom:"\u2318Z"},redo:{default:"\u2318Y",custom:"\u2318Y"},rename:{default:"F2",custom:"F2"},newNameFile:{default:"F3",custom:"F3"},newContentFile:{default:"F4",custom:"F4"},newNameSettingFile:{default:"\u2318F3",custom:"\u2318F3"},showInFolder:{default:"\u2325A",custom:"\u2325A"},outline:{default:"\u2325O",custom:"\u2325O"},backlinks:{default:"\u2325B",custom:"\u2325B"},graphView:{default:"\u2325G",custom:"\u2325G"},spaceRepetition:{default:"\u2325F",custom:"\u2325F"},fullscreen:{default:"\u2325Y",custom:"\u2325Y"},alignLeft:{default:"\u2325L",custom:"\u2325L"},alignCenter:{default:"\u2325C",custom:"\u2325C"},alignRight:{default:"\u2325R",custom:"\u2325R"},wysiwyg:{default:"\u2325\u23187",custom:"\u2325\u23187"},preview:{default:"\u2325\u23189",custom:"\u2325\u23189"},insertBefore:{default:"\u21E7\u2318B",custom:"\u21E7\u2318B"},insertAfter:{default:"\u21E7\u2318A",custom:"\u21E7\u2318A"},jumpToParentNext:{default:"\u21E7\u2318N",custom:"\u21E7\u2318N"},jumpToParentPrev:{default:"\u21E7\u2318M",custom:"\u21E7\u2318M"},jumpToParent:{default:"\u21E7\u2318J",custom:"\u21E7\u2318J"},moveToUp:{default:"\u21E7\u2318\u2191",custom:"\u21E7\u2318\u2191"},moveToDown:{default:"\u21E7\u2318\u2193",custom:"\u21E7\u2318\u2193"},duplicateCompletely:{default:"",custom:""},copyPlainText:{default:"",custom:""},copyID:{default:"",custom:""},copyProtocolInMd:{default:"",custom:""},netImg2LocalAsset:{default:"",custom:""},netAssets2LocalAssets:{default:"",custom:""},optimizeTypography:{default:"",custom:""},hLayout:{default:"",custom:""},vLayout:{default:"",custom:""},refPopover:{default:"",custom:""},copyText:{default:"",custom:""},exitFocus:{default:"",custom:""},ai:{default:"",custom:""},switchReadonly:{default:"",custom:""},switchAdjust:{default:"",custom:""},rtl:{default:"",custom:""},ltr:{default:"",custom:""},aiWriting:{default:"",custom:""},openInNewTab:{default:"",custom:""}},insert:{appearance:{default:"\u2325\u2318X",custom:"\u2325\u2318X"},lastUsed:{default:"\u2325X",custom:"\u2325X"},ref:{default:"\u2325[",custom:"\u2325["},kbd:{default:"\u2318'",custom:"\u2318'"},sup:{default:"\u2318H",custom:"\u2318H"},sub:{default:"\u2318J",custom:"\u2318J"},bold:{default:"\u2318B",custom:"\u2318B"},"inline-math":{default:"\u2318M",custom:"\u2318M"},memo:{default:"\u2325\u2318M",custom:"\u2325\u2318M"},underline:{default:"\u2318U",custom:"\u2318U"},italic:{default:"\u2318I",custom:"\u2318I"},mark:{default:"\u2325D",custom:"\u2325D"},tag:{default:"\u2318T",custom:"\u2318T"},strike:{default:"\u21E7\u2318S",custom:"\u21E7\u2318S"},"inline-code":{default:"\u2318G",custom:"\u2318G"},link:{default:"\u2318K",custom:"\u2318K"},check:{default:"\u2318L",custom:"\u2318L"},"ordered-list":{default:"",custom:""},list:{default:"",custom:""},table:{default:"\u2318O",custom:"\u2318O"},code:{default:"\u21E7\u2318K",custom:"\u21E7\u2318K"},quote:{default:"",custom:""},clearInline:{default:"\u2318\\",custom:"\u2318\\"}},heading:{paragraph:{default:"\u2325\u23180",custom:"\u2325\u23180"},heading1:{default:"\u2325\u23181",custom:"\u2325\u23181"},heading2:{default:"\u2325\u23182",custom:"\u2325\u23182"},heading3:{default:"\u2325\u23183",custom:"\u2325\u23183"},heading4:{default:"\u2325\u23184",custom:"\u2325\u23184"},heading5:{default:"\u2325\u23185",custom:"\u2325\u23185"},heading6:{default:"\u2325\u23186",custom:"\u2325\u23186"}},list:{indent:{default:"\u21E5",custom:"\u21E5"},outdent:{default:"\u21E7\u21E5",custom:"\u21E7\u21E5"},checkToggle:{default:"\u2318\u21A9",custom:"\u2318\u21A9"}},table:{insertRowAbove:{default:"",custom:""},insertRowBelow:{default:"",custom:""},insertColumnLeft:{default:"",custom:""},insertColumnRight:{default:"",custom:""},moveToUp:{default:"\u2325\u2318T",custom:"\u2325\u2318T"},moveToDown:{default:"\u2325\u2318B",custom:"\u2325\u2318B"},moveToLeft:{default:"\u2325\u2318L",custom:"\u2325\u2318L"},moveToRight:{default:"\u2325\u2318R",custom:"\u2325\u2318R"},"delete-row":{default:"\u2318-",custom:"\u2318-"},"delete-column":{default:"\u21E7\u2318-",custom:"\u21E7\u2318-"}}},plugin:{}},i.SIYUAN_EMPTY_LAYOUT={hideDock:!1,layout:{direction:"tb",size:"0px",type:"normal",instance:"Layout",children:[{direction:"lr",size:"auto",type:"normal",instance:"Layout",children:[{direction:"tb",size:"0px",type:"left",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"tb",children:[]}]},{direction:"lr",resize:"lr",size:"auto",type:"center",instance:"Layout",children:[{instance:"Wnd",children:[{instance:"Tab",children:[]}]}]},{direction:"tb",size:"0px",resize:"lr",type:"right",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"tb",children:[]}]}]},{direction:"lr",size:"0px",resize:"tb",type:"bottom",instance:"Layout",children:[{instance:"Wnd",children:[]},{instance:"Wnd",resize:"lr",children:[]}]}]},bottom:{pin:!0,data:[]},left:{pin:!0,data:[[{type:"file",size:{width:232,height:0},show:!0,icon:"iconFiles",hotkeyLangId:"fileTree"},{type:"outline",size:{width:232,height:0},show:!1,icon:"iconAlignCenter",hotkeyLangId:"outline"},{type:"inbox",size:{width:320,height:0},show:!1,icon:"iconInbox",hotkeyLangId:"inbox"}],[{type:"bookmark",size:{width:232,height:0},show:!1,icon:"iconBookmark",hotkeyLangId:"bookmark"},{type:"tag",size:{width:232,height:0},show:!1,icon:"iconTags",hotkeyLangId:"tag"}]]},right:{pin:!0,data:[[{type:"graph",size:{width:320,height:0},show:!1,icon:"iconGraph",hotkeyLangId:"graphView"},{type:"globalGraph",size:{width:320,height:0},show:!1,icon:"iconGlobalGraph",hotkeyLangId:"globalGraph"}],[{type:"backlink",size:{width:320,height:0},show:!1,icon:"iconLink",hotkeyLangId:"backlinks"}]]}},i.SIYUAN_DEFAULT_REPLACETYPES={text:!0,imgText:!0,imgTitle:!0,imgSrc:!0,aText:!0,aTitle:!0,aHref:!0,code:!0,em:!0,strong:!0,inlineMath:!0,inlineMemo:!0,blockRef:!0,fileAnnotationRef:!0,kbd:!0,mark:!0,s:!0,sub:!0,sup:!0,tag:!0,u:!0,docTitle:!0,codeBlock:!0,mathBlock:!0,htmlBlock:!0},i.SIYUAN_IMAGE_VIP=`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
<path fill="#ffd00f" d="M2.288 12.643l23.487 12.853c0.286 0.153 0.477 0.45 0.477 0.791 0 0.082-0.011 0.161-0.032 0.237l0.001-0.006c-0.119 0.395-0.479 0.678-0.905 0.678-0.004 0-0.009-0-0.013-0h-19.439c-0.958 0-1.766-0.684-1.885-1.595l-1.691-12.956z"></path>
<path fill="#ffd00f" d="M29.676 12.643l-1.691 12.957c-0.119 0.911-0.927 1.594-1.884 1.594h-19.442c-0.004 0-0.009 0-0.013 0-0.425 0-0.785-0.281-0.903-0.668l-0.002-0.007c-0.019-0.070-0.031-0.15-0.031-0.232 0-0.341 0.191-0.638 0.472-0.788l0.005-0.002 23.487-12.853z"></path>
<path fill="#ffe668" d="M15.413 8.369l10.394 15.921c0.378 0.579 0.407 1.317 0.076 1.924-0.328 0.591-0.948 0.985-1.66 0.985-0 0-0.001 0-0.001 0h-17.617c-0.694 0-1.331-0.378-1.661-0.985-0.144-0.26-0.229-0.569-0.229-0.899 0-0.382 0.114-0.736 0.31-1.033l-0.004 0.007 10.394-15.921z"></path>
<path fill="#ffdd4e" d="M15.396 8.403l11.659 15.921c0.401 0.579 0.432 1.317 0.081 1.924-0.361 0.594-1.005 0.985-1.741 0.985-0.008 0-0.017-0-0.025-0h-9.344l-0.63-18.83z"></path>
<path fill="#ffd00f" d="M13.868 6.478c0 0.946 0.767 1.712 1.712 1.712s1.712-0.767 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0zM28.577 10.818c0 0.945 0.766 1.712 1.712 1.712s1.712-0.766 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0zM0 10.822c0 0.945 0.766 1.712 1.712 1.712s1.712-0.766 1.712-1.712v0c0-0.945-0.766-1.712-1.712-1.712s-1.712 0.766-1.712 1.712v0z"></path>
</svg>`,i.SIYUAN_ASSETS_IMAGE=[".apng",".ico",".cur",".jpg",".jpe",".jpeg",".jfif",".pjp",".pjpeg",".png",".gif",".webp",".bmp",".svg",".avif",".tiff",".tif"],i.SIYUAN_ASSETS_AUDIO=[".mp3",".wav",".ogg",".m4a",".aac",".flac"],i.SIYUAN_ASSETS_VIDEO=[".mov",".weba",".mkv",".mp4",".webm"],i.SIYUAN_ASSETS_EXTS=[".pdf"].concat(i.SIYUAN_ASSETS_IMAGE,i.SIYUAN_ASSETS_AUDIO,i.SIYUAN_ASSETS_VIDEO),i.SIYUAN_ASSETS_SEARCH=[".txt",".md",".markdown",".docx",".xlsx",".pptx",".pdf",".json",".log",".sql",".html",".xml",".java",".h",".c",".cpp",".go",".rs",".swift",".kt",".py",".php",".js",".css",".ts",".sh",".bat",".cmd",".ini",".yaml",".rst",".adoc",".textile",".opml",".org",".wiki",".epub",".cs"],i.SIYUAN_CONFIG_APPEARANCE_DARK_CODE=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","cybertopia-cherry","cybertopia-dimmer","cybertopia-icecap","cybertopia-saturated","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","rose-pine","rose-pine-moon","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256"],i.SIYUAN_CONFIG_APPEARANCE_LIGHT_CODE=["ant-design","1c-light","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","rose-pine-dawn","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],i.ZWSP="\u200B",i.INLINE_TYPE=["block-ref","kbd","text","file-annotation-ref","a","strong","em","u","s","mark","sup","sub","tag","code","inline-math","inline-memo","clear"],i.BLOCK_HINT_KEYS=["((","[[","\uFF08\uFF08","\u3010\u3010"],i.BLOCK_HINT_CLOSE_KEYS={"((":"))","[[":"]]","\uFF08\uFF08":"\uFF09\uFF09","\u3010\u3010":"\u3011\u3011"},i.ALIAS_CODE_LANGUAGES=["js","ts","html","toml","c#","bat"],i.SIYUAN_RENDER_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math"],i.PROTYLE_TOOLBAR=G()?["block-ref","a","|","text","strong","em","u","clear","|","code","tag","inline-math","inline-memo"]:["block-ref","a","|","text","strong","em","u","s","mark","sup","sub","clear","|","code","kbd","tag","inline-math","inline-memo"];let c=i;const Fe=(e,t,s=!1)=>{let n=b(e,t,s),a=!1,l=!1;for(;n&&(s?n.tagName!=="BODY":!n.classList.contains("protyle-wysiwyg"))&&!l;)a=b(n.parentElement,t,s),a?n=a:l=!0;return n||!1},We=(e,t)=>{let s=F(e,t),n=!1,a=!1;for(;s&&!s.classList.contains("protyle-wysiwyg")&&!a;)n=F(s.parentElement,t),n?s=n:a=!0;return s||!1},ae=(e,t,s,n=!1)=>{let a=w(e,t,s,n),l=!1,r=!1;for(;a&&!a.classList.contains("protyle-wysiwyg")&&!r;)l=w(a.parentElement,t,s,n),l?a=l:r=!0;return a||!1},w=(e,t,s,n=!1)=>{var a;if(!e||e.nodeType===9)return!1;e.nodeType===3&&(e=e.parentElement);let l=e,r=!1;for(;l&&!r&&(n?l.tagName!=="BODY":!l.classList.contains("protyle-wysiwyg"));)typeof s=="string"&&((a=l.getAttribute(t))!=null&&a.split(" ").includes(s))||typeof s!="string"&&l.hasAttribute(t)?r=!0:l=l.parentElement;return r&&l},F=(e,t)=>{if(!e||e.nodeType===9)return!1;e.nodeType===3&&(e=e.parentElement);let s=e,n=!1;for(;s&&!n&&!s.classList.contains("protyle-wysiwyg");)s.nodeName===t?n=!0:s=s.parentElement;return n&&s},b=(e,t,s=!1)=>{var n;if(!e||e.nodeType===9)return!1;e.nodeType===3&&(e=e.parentElement);let a=e,l=!1;for(;a&&!l&&(s?a.tagName!=="BODY":!a.classList.contains("protyle-wysiwyg"));)(n=a.classList)!=null&&n.contains(t)?l=!0:a=a.parentElement;return l&&a},O=e=>{var t;const s=w(e,"data-node-id",null);return s&&s.tagName!=="BUTTON"&&((t=s.getAttribute("data-type"))!=null&&t.startsWith("Node"))?s:!1},ne=e=>{const t=ae(e,"data-type","NodeBlockQueryEmbed");return t?t===e?!1:t:!1},je=e=>b(e,"av__gallery-cover")?b(e,"av"):!1,P=(e,t)=>{if(!document.getElementById(t)){const s=document.createElement("link");s.id=t,s.rel="stylesheet",s.type="text/css",s.href=e;const n=document.querySelector("#pluginsStyle");n?n.before(s):document.getElementsByTagName("head")[0].appendChild(s)}},T=(e,t=["edit","more"])=>{let s=!0;if(e){const n=e.getAttribute("data-readonly");if(typeof n=="string")s=n==="false";else return'<div class="protyle-icons"></div>'}return t.length===3?`<div class="protyle-icons">
    <span aria-label="${window.siyuan.languages.refresh}" data-position="4north" class="ariaLabel protyle-icon protyle-icon--first protyle-action__reload"><svg><use xlink:href="#iconRefresh"></use></svg></span>
    <span aria-label="${window.siyuan.languages.edit}" data-position="4north" class="ariaLabel protyle-icon protyle-action__edit${s?"":" fn__none"}"><svg><use xlink:href="#iconEdit"></use></svg></span>
    <span aria-label="${window.siyuan.languages.more}" data-position="4north" class="ariaLabel protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span>
</div>`:`<div class="protyle-icons">
    <span aria-label="${window.siyuan.languages.edit}" data-position="4north" class="ariaLabel protyle-icon protyle-icon--first protyle-action__edit${s?"":" fn__none"}"><svg><use xlink:href="#iconEdit"></use></svg></span>
    <span aria-label="${window.siyuan.languages.more}" data-position="4north" class="ariaLabel protyle-icon protyle-action__menu protyle-icon--last${s?"":" protyle-icon--first"}"><svg><use xlink:href="#iconMore"></use></svg></span>
</div>`},M=e=>{if(e.querySelector(".protyle-cursor"))return;const t=e.getAttribute("data-type");t==="NodeBlockQueryEmbed"?e.insertAdjacentHTML("afterbegin",`<div class="protyle-icons${ne(e)?" fn__none":""}">
    <span aria-label="${window.siyuan.languages.refresh}" data-position="4north" class="ariaLabel protyle-icon protyle-action__reload protyle-icon--first"><svg class="fn__rotate"><use xlink:href="#iconRefresh"></use></svg></span>
    <span aria-label="${window.siyuan.languages.update} SQL" data-position="4north" class="ariaLabel protyle-icon protyle-action__edit"><svg><use xlink:href="#iconEdit"></use></svg></span>
    <span aria-label="${window.siyuan.languages.more}" data-position="4north" class="ariaLabel protyle-icon protyle-action__menu protyle-icon--last"><svg><use xlink:href="#iconMore"></use></svg></span>
</div><div class="protyle-cursor">${c.ZWSP}</div>`):(t==="NodeMathBlock"||e.getAttribute("data-subtype")==="math")&&(e.firstElementChild.innerHTML=`<span></span><span class="protyle-cursor">${c.ZWSP}</span>`)},Ye=e=>(e.querySelectorAll("protyle-html").forEach(t=>{t.setAttribute("data-content",Lute.UnEscapeHTMLStr(t.getAttribute("data-content")))}),e),le=(e=c.PROTYLE_CDN)=>{const t=document.getElementById("protyleHljsStyle");let s;window.siyuan.config.appearance.mode===0?(s=window.siyuan.config.appearance.codeBlockThemeLight,c.SIYUAN_CONFIG_APPEARANCE_LIGHT_CODE.includes(s)||(s="default")):(s=window.siyuan.config.appearance.codeBlockThemeDark,c.SIYUAN_CONFIG_APPEARANCE_DARK_CODE.includes(s)||(s="github-dark"));const n=`${e}/js/highlight.js/styles/${s}.min.css?v=11.11.1`;t?t.href.includes(n)||(t.remove(),P(n,"protyleHljsStyle")):P(n,"protyleHljsStyle")},re=(e,t=c.PROTYLE_CDN)=>{let s=[];e.getAttribute("data-subtype")==="graphviz"?s=[e]:s=Array.from(e.querySelectorAll('[data-subtype="graphviz"]')),s.length!==0&&g(`${t}/js/graphviz/viz.js?v=3.11.0`,"protyleGraphVizScript").then(()=>{const n=b(e,"protyle-wysiwyg",!0);s.forEach(a=>{if(a.getAttribute("data-render")==="true")return;a.firstElementChild.classList.contains("protyle-icons")||a.insertAdjacentHTML("afterbegin",T(n));const l=a.firstElementChild.nextElementSibling;if(!a.getAttribute("data-content")){l.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span>`;return}try{Viz.instance().then(r=>{const o=r.renderSVGElement(Lute.UnEscapeHTMLStr(a.getAttribute("data-content")));l.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div contenteditable="false">${o.outerHTML}</div>`}).catch(r=>{l.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div class="ft__error" contenteditable="false">graphviz render error: <br>${r}</div>`})}catch(r){console.error("Graphviz error",r)}a.setAttribute("data-render","true")})})},$e=e=>e.parentElement.classList.contains("callout-content")?e.parentElement.parentElement:e.parentElement,qe=e=>{const t=e.querySelector(".callout-icon").textContent;return(t?t+" ":"")+e.querySelector(".callout-title").textContent},oe=e=>{let t=e;for(;t;){if(t.previousElementSibling&&t.previousElementSibling.getAttribute("data-node-id"))return t.previousElementSibling;const s=O(t.parentElement);if(s)t=s;else return!1}},ze=e=>{let t;return Array.from(e.querySelectorAll("[data-node-id]")).reverse().find(s=>{if(!isInEmbedBlock(s))return t=s,!0}),t||e},Ke=e=>{let t;return Array.from(e.querySelectorAll("[data-node-id]")).find(s=>{if(!isInEmbedBlock(s)&&!s.classList.contains("li")&&!s.classList.contains("sb"))return t=s,!0}),t||e},ue=e=>{let t=e;for(;t;){if(t.nextElementSibling&&!t.nextElementSibling.classList.contains("protyle-attr"))return t.nextElementSibling;const s=O(t.parentElement);if(s)t=s;else return!1}return!1},Ve=e=>{let t=e;for(;t;)if(t.classList.contains("list")||t.classList.contains("li")||t.classList.contains("bq")||t.classList.contains("sb"))t=t.querySelector("[data-node-id]");else return t;return!1},_=e=>{if(!e||e.classList.contains("protyle-title__input"))return e;let t=e;if(t.getAttribute("data-node-id")||(t=e.querySelector("[data-node-id]")),!t){const n=O(e);return n&&e===_(n)?e:void 0}const s=t.getAttribute("data-type");if(["NodeParagraph","NodeHeading"].includes(s))return t.firstElementChild;if(s==="NodeTable")return t.querySelector("table");if(s==="NodeCodeBlock"&&t.classList.contains("code-block"))return t.querySelector(".hljs").lastElementChild;if(s==="NodeAttributeView")return t.querySelector(".av__title");if(["NodeBlockQueryEmbed","NodeMathBlock","NodeHTMLBlock"].includes(s))return;if(t.getAttribute("data-node-id"))return _(t.querySelector("[data-node-id]"))},W=e=>e.classList.contains("list")||e.classList.contains("li")||e.classList.contains("sb")||e.classList.contains("bq")||e.classList.contains("callout"),j=e=>{if(W(e)){let t=!1;return Array.from(e.querySelectorAll("[data-node-id]")).find(s=>{if(!j(s))return t=!0,!0}),!t}return["NodeBlockQueryEmbed","NodeThematicBreak","NodeMathBlock","NodeHTMLBlock","NodeIFrame","NodeWidget","NodeVideo","NodeAudio"].includes(e.getAttribute("data-type"))||e.getAttribute("data-type")==="NodeCodeBlock"&&e.classList.contains("render-node")},Ze=e=>{var t,s;let n=e;for(;n.parentElement&&!n.parentElement.classList.contains("protyle-wysiwyg");)if(!n.parentElement.getAttribute("data-node-id")&&!n.parentElement.classList.contains("callout-content"))n=n.parentElement;else{let a=!1;if(Array.from(n.parentElement.querySelectorAll('[contenteditable="true"]')).find(l=>{if(l.textContent.replace(Constants.ZWSP,"").replace(`
`,"")!=="")return a=!0,!0}),a||(t=n.previousElementSibling)!=null&&t.getAttribute("data-node-id")||(s=n.nextElementSibling)!=null&&s.getAttribute("data-node-id"))break;n=n.parentElement}return n},v=e=>{if(e.parentElement.getAttribute("data-type")==="NodeBlockquote"&&e.parentElement.childElementCount===2)for(;e.parentElement&&!e.parentElement.classList.contains("protyle-wysiwyg");)if(e.parentElement.getAttribute("data-type")==="NodeBlockquote"&&e.parentElement.childElementCount===2)e=e.parentElement;else{e=v(e);break}else if(e.parentElement.classList.contains("callout-content")&&e.parentElement.childElementCount===1)for(;e.parentElement&&!e.parentElement.classList.contains("protyle-wysiwyg");)if(e.parentElement.classList.contains("callout-content")&&e.parentElement.childElementCount===1)e=e.parentElement.parentElement;else{e=v(e);break}else if(e.parentElement.getAttribute("data-type")==="NodeSuperBlock"&&e.parentElement.childElementCount===2)for(;e.parentElement&&!e.parentElement.classList.contains("protyle-wysiwyg");)if(e.parentElement.getAttribute("data-type")==="NodeSuperBlock"&&e.parentElement.childElementCount===2)e=e.parentElement;else{e=v(e);break}else if(e.parentElement.getAttribute("data-type")==="NodeListItem"&&e.parentElement.childElementCount===3)for(;e.parentElement&&!e.parentElement.classList.contains("protyle-wysiwyg");)if(e.parentElement.getAttribute("data-type")==="NodeListItem"&&e.parentElement.childElementCount===3)e=e.parentElement;else if(e.parentElement.getAttribute("data-type")==="NodeList"&&e.parentElement.childElementCount===2)e=e.parentElement;else{e=v(e);break}else if(e.parentElement.getAttribute("data-type")==="NodeList"&&e.parentElement.childElementCount===2)for(;e.parentElement&&!e.parentElement.classList.contains("protyle-wysiwyg");)if(e.parentElement.getAttribute("data-type")==="NodeList"&&e.parentElement.childElementCount===2)e=e.parentElement;else if(e.parentElement.getAttribute("data-type")==="NodeListItem"&&e.parentElement.childElementCount===3)e=e.parentElement;else{e=v(e);break}return e},Y=e=>{let t=e.nextSibling;for(;t;)if(t.textContent===""&&t.nodeType===3)t=t.nextSibling;else return t;return!1},Xe=e=>{if(e.endContainer.nodeType===3&&e.endContainer.textContent.length!==e.endOffset&&e.endContainer.textContent!==Constants.ZWSP&&e.endContainer.textContent!==`
`)return!1;let t=e.endContainer;if(e.endContainer.nodeType!==3){if(t=e.endContainer.childNodes[e.endOffset],!t)e.endContainer.parentElement.getAttribute("spellcheck")&&(t=e.endContainer);else if(t.nodeType===3&&!e.endContainer.childNodes[e.endOffset+1])return t.textContent===Constants.ZWSP||t.textContent===`
`}for(;t;){if(Y(t))return!1;if(t.parentElement.getAttribute("spellcheck"))return!0;t=t.parentElement}return!0},$=e=>{let t=e.previousSibling;for(;t;)if(t.textContent===""&&t.nodeType===3)t=t.previousSibling;else return t;return!1},Je=e=>{let t=e.nextElementSibling;if(t)return t.tagName==="LI"?t:t.tagName==="UL"?t.firstElementChild:!1;for(t=e.parentElement;t.tagName==="UL";)if(!t.nextElementSibling)t=t.parentElement;else{if(t.nextElementSibling.tagName==="LI")return t.nextElementSibling;if(t.nextElementSibling.tagName==="UL")return t.nextElementSibling.firstElementChild}return!1},Qe=e=>{let t=e.previousElementSibling;if(t)return t.tagName==="LI"?t:t.tagName==="UL"?t.lastElementChild:!1;for(t=e.parentElement;t.tagName==="UL";)if(!t.previousElementSibling)t=t.parentElement;else{if(t.previousElementSibling.tagName==="LI")return t.previousElementSibling;if(t.previousElementSibling.tagName==="UL"){const s=t.previousElementSibling.querySelectorAll(".b3-list-item");return s[s.length-1]}}return!1},de=(e,t)=>{if(!t){if(getSelection().rangeCount===0)return!1;t=getSelection().getRangeAt(0)}const s=t.commonAncestorContainer;return e.isEqualNode(s)||e.contains(s)},et=e=>{const t=hasClosestByAttribute(e.startContainer,"data-type","NodeTable");if(e.toString()!==""&&t&&e.commonAncestorContainer.nodeType!==3){const s=e.commonAncestorContainer.tagName;if(s!=="TH"&&s!=="TD"){const n=hasClosestByTag(e.startContainer,"TD")||hasClosestByTag(e.startContainer,"TH"),a=hasClosestByTag(e.endContainer,"TD")||hasClosestByTag(e.endContainer,"TH");if(!n&&!a){const l=t.querySelector("th")||t.querySelector("td");e.setStart(l.firstChild,0),e.setEnd(l.lastChild,l.lastChild.textContent.length)}else n&&!n.contains(e.endContainer)&&x(n,e,!1)}}},tt=(e,t,s)=>{const n=getContenteditableElement(t);if(n){let r;if(n.tagName==="TABLE"){const o=hasClosestByTag(s.startContainer,"TD")||hasClosestByTag(s.startContainer,"TH");if(o&&(r=B(o,t,s),r.start!==0||r.end!==o.textContent.length))return s.setStart(o.firstChild,0),s.setEndAfter(o.lastChild),e.toolbar.render(e,s),countSelectWord(s,e.block.rootID),!0}else if(r=B(n,t,s),r.start!==0||r.end!==n.textContent.length){let o=n.firstChild;for(;o;)if(o.nodeType===3){if(o.textContent!==""){s.setStart(o,0);break}o=o.nextSibling}else{if(o.classList.contains("render-node")||o.classList.contains("img")){s.setStartBefore(o);break}o=o.firstChild}let u=n.lastChild;for(;u;)if(u.nodeType===3){if(u.textContent!==""){s.setEnd(u,u.textContent.length);break}u=u.previousSibling}else{if(u.classList.contains("render-node")||u.classList.contains("img")||u.tagName==="BR"){s.setEndAfter(u);break}u=u.lastChild}return N(s),e.toolbar.render(e,s),countSelectWord(s,e.block.rootID),!0}}s.collapse(!0);const a=e.wysiwyg.element.querySelectorAll(".protyle-wysiwyg--select");if(e.wysiwyg.element.childElementCount===a.length&&a[0].parentElement===e.wysiwyg.element)return!0;hideElements(["select"],e);const l=[];Array.from(e.wysiwyg.element.children).forEach(r=>{const o=r.getAttribute("data-node-id");o&&(r.classList.add("protyle-wysiwyg--select"),l.push(o))}),countBlockWord(l,e.block.rootID)},st=(e,t)=>{const s=document.caretRangeFromPoint(e,t),n=hasClosestByAttribute(s.startContainer,"data-type","img");return n&&(s.setStart(n.nextSibling,0),s.collapse()),s},S=e=>{var t,s,n;let a;if(getSelection().rangeCount>0&&(a=getSelection().getRangeAt(0),e===a.startContainer||e.contains(a.startContainer))){if(a.toString()===""&&a.startContainer.nodeType===1){if(a.startOffset===0&&a.startContainer.classList.contains("protyle-wysiwyg")){const r=I(a.startContainer.firstChild);if(r)return r}if(a.startContainer.getAttribute("contenteditable")!=="true"&&_(a.startContainer)){const r=O(a.startContainer);if(r){const o=I(r);if(o)return o}}}return a}if(e.classList.contains("li")||e.classList.contains("list")){const r=e.querySelector("[data-node-id]");if(r)return S(r)}e.focus({preventScroll:!0}),a||(a=document.createRange());let l;if(e.classList.contains("table"))l=e.querySelector("th")||e.querySelector("td");else if(l=_(e),l)l.tagName==="TABLE"&&(l=l.querySelector("th")||e.querySelector("td"));else{const r=e.getAttribute("data-type");r==="NodeThematicBreak"?l=e.firstElementChild:r==="NodeBlockQueryEmbed"?l=(t=e.querySelector(".protyle-cursor"))==null?void 0:t.firstChild:["NodeMathBlock","NodeHTMLBlock"].includes(r)?l=(n=(s=e.lastElementChild.previousElementSibling)==null?void 0:s.lastElementChild)==null?void 0:n.firstChild:r==="NodeVideo"?l=e.firstElementChild.firstChild:r==="NodeAudio"&&(l=e.firstElementChild.lastChild)}return a.setStart(l||e,0),a.collapse(!0),a},it=(e,t,s=!1)=>{var n,a;if(t||(t=S(e)),!e.contains(t.startContainer))return{left:0,top:0};let l;if(t.getClientRects().length===0)if(t.startContainer.nodeType===3){const r=(n=t.startContainer.parentElement)==null?void 0:n.getClientRects(),o=(a=t.startContainer.previousElementSibling)==null?void 0:a.getClientRects();if(r.length>0||o.length>0)r.length===0||o&&o.length>0&&r[0].top<o[o.length-1].bottom?l={left:o[o.length-1].left,top:o[o.length-1].bottom}:l=r[0];else return{left:0,top:0}}else{const r=t.startContainer.children;if(r[t.startOffset]&&r[t.startOffset].getClientRects().length>0)l=r[t.startOffset].getClientRects()[0];else if(t.startContainer.childNodes.length>0){const o=t.cloneRange();if(t.startOffset===0){let u=t.startContainer.childNodes[t.startOffset]||t.startContainer.firstChild;for(;u&&(u.textContent===""&&u.nodeType===3);)u=u.previousSibling;t.selectNodeContents(u),t.collapse(!0)}else{let u=t.startContainer.childNodes[t.startOffset]||t.startContainer.lastChild;for(;u&&(u.textContent===""&&u.nodeType===3);)u=u.previousSibling;t.selectNodeContents(u),t.collapse(!1)}l=t.getClientRects()[0],t.setEnd(o.endContainer,o.endOffset),t.setStart(o.startContainer,o.startOffset)}else l=t.startContainer.getClientRects()[0];if(!l){let o=t.startContainer.childNodes[t.startOffset];if(o||(o=t.startContainer.childNodes[t.startOffset-1]),!o)l=t.getBoundingClientRect();else{for(;!o.getClientRects||o.getClientRects&&o.getClientRects().length===0;)o=o.parentElement;l=o.getClientRects()[0]}}}else{const r=t.getClientRects();if(t.toString())if(s){const o=window.getSelection(),u=o&&"direction"in o&&o.direction!=="none"?o.direction==="backward":t.startContainer===(o==null?void 0:o.focusNode)&&t.startOffset===(o==null?void 0:o.focusOffset),d=!u&&r[0].top!==r[r.length-1].top;return{left:u?r[0].left:r[r.length-1].right,top:d?r[r.length-1].bottom:r[0].top,isBottom:d}}else return{left:r[r.length-1].left,top:r[0].top};else return{left:r[r.length-1].left,top:r[r.length-1].top}}return{left:l.left,top:l.top}},B=(e,t,s)=>{const n={end:0,start:0};if(!s){if(getSelection().rangeCount===0)return n;s=window.getSelection().getRangeAt(0)}if(t&&!de(t,s))return n;const a=s.cloneRange();return e.childNodes[0]&&e.childNodes[0].childNodes[0]?a.setStart(e.childNodes[0].childNodes[0],0):a.selectNodeContents(e),a.setEnd(s.startContainer,s.startOffset),n.start=a.toString().length+a.cloneContents().querySelectorAll("br").length,n.end=n.start+s.toString().length+s.cloneContents().querySelectorAll("br").length,n};function k(e,t,s,n){if(!t)return!1;if(s(t))return!0;for(let a=0,l=t.childNodes.length;a<l;a++)if(k(t,t.childNodes[a],s,!0))return!0;if(!n){let a=t;for(;a&&a!==e;){let l=a.nextSibling;for(;l;){if(k(e,l,s,!0))return!0;l=l.nextSibling}a=a.parentNode}}return!1}const x=(e,t,s=!0)=>{if(!e)return t;let n=e.lastChild;for(;n&&n.nodeType!==3&&n.lastChild;)n=n.lastChild;return n||(n=e),s?n.nodeType!==3&&(n.classList.contains("render-node")||n.tagName==="BR")&&n.innerHTML===""?t.setStartAfter(n):t.setStart(n,n.textContent.length):n.nodeType!==3&&(n.classList.contains("render-node")||n.tagName==="BR")&&n.innerHTML===""?t.setEndAfter(n):t.setEnd(n,n.textContent.length),t},ce=(e,t)=>{if(!e)return t;let s=e.firstChild;for(;s&&s.nodeType!==3&&!s.classList.contains("render-node");){if(s.classList.contains("img"))return t.setStartBefore(s),t;s=s.firstChild}return s?(s.nodeType!==3&&s.classList.contains("render-node")?t.setStartBefore(s):t.setStart(s,0),t):(t.selectNodeContents(e),t)},q=(e,t,s,n=!0)=>{if(!e)return!1;const a=_(e);if(a)e=a;else if(n&&(j(e)||e.classList.contains("av")))return I(e);let l;k(e,e.firstChild,u=>{if(u.nodeType===Node.TEXT_NODE){const d=u.data.length;return t<=d?(l=u,!0):(t-=d,s-=d,!1)}else if(u.nodeType===Node.ELEMENT_NODE&&u.tagName==="BR")return t<=1?(l=u,!0):(t-=1,s-=1,!1)});let r;l&&k(e,l,u=>{if(u.nodeType===Node.TEXT_NODE){const d=u.data.length;return s<=d?(r=u,!0):(s-=d,!1)}});const o=document.createRange();return l?l.nodeType===Node.TEXT_NODE&&t<=l.data.length?o.setStart(l,t):o.setStartAfter(l):t===0?o.setStart(e,0):x(_(e),o),r?s<=r.data.length?o.setEnd(r,s):o.setEndAfter(r):s===0?o.setEnd(e,0):x(_(e),o,!1),n&&N(o),o},at=(e,t,s)=>{const n=getContenteditableElement(e);if(!n)return;const a=B(n,e,t),l=e.cloneNode(!0),r=q(l,a.end,a.end,!1);r&&r.insertNode(document.createElement("wbr")),s.wysiwyg.lastHTMLs[e.getAttribute("data-node-id")]=l.outerHTML},nt=(e,t)=>{var s;const n=e.querySelectorAll("wbr");if(n.length===0)return;n.forEach((l,r)=>{r!==0&&l.remove()});const a=n[0];if(!a.previousElementSibling)a.previousSibling?t.setStart(a.previousSibling,a.previousSibling.textContent.length):a.nextSibling?a.nextSibling.nodeType===3?a.nextSibling.textContent===Constants.ZWSP?t.setStart(a.nextSibling,1):t.setStart(a.nextSibling,0):t.setStartAfter(a):t.setStart(a.parentElement,0);else{const l=hasPreviousSibling(a);l&&a.previousElementSibling===l?((s=a.previousElementSibling.lastChild)==null?void 0:s.nodeType)===3?t.setStart(a.previousElementSibling.lastChild,a.previousElementSibling.lastChild.textContent.length):l.nodeType!==3&&l.classList.contains("img")?t.setStartAfter(l):t.setStartBefore(a):t.setStart(a.previousSibling,a.previousSibling.textContent.length)}return t.collapse(!0),a.remove(),N(t),t},N=e=>{if(!e)return;const t=e.startContainer.childNodes[e.startOffset];if(t&&t.nodeType!==3&&["INPUT","TEXTAREA"].includes(t.tagName)){t.focus();return}const s=window.getSelection();s.removeAllRanges(),s.addRange(e)},I=(e,t,s=!0)=>{if(!e)return!1;if(e.classList.contains("render-node")||e.classList.contains("iframe")||e.classList.contains("hr")||e.classList.contains("av")){const a=document.createRange(),l=e.getAttribute("data-type");let r=!1;if(l==="NodeThematicBreak")a.selectNodeContents(e.firstElementChild),r=!0;else if(l==="NodeBlockQueryEmbed")M(e),a.setStart(e.querySelector(".protyle-cursor").firstChild,0),a.collapse(!0),r=!0;else if(l==="NodeMathBlock")M(e),a.setStart(e.firstElementChild.lastElementChild.firstChild,0),r=!0;else if(l==="NodeHTMLBlock")a.setStart(e.lastElementChild.previousElementSibling.lastElementChild.firstChild,0),a.collapse(!0),r=!0;else if(l==="NodeIFrame"||l==="NodeWidget")a.setStart(e,0),r=!0;else if(l==="NodeVideo")a.setStart(e.firstElementChild.firstChild,0),r=!0;else if(l==="NodeAudio")a.setStart(e.firstElementChild.lastChild,0),r=!0;else if(l==="NodeCodeBlock")a.selectNodeContents(e),a.collapse(!0),r=!0;else if(l==="NodeAttributeView")return!1;return r?(N(a),a):(fe(e),!1)}let n;if(s?n=_(e):Array.from(e.querySelectorAll('[contenteditable="true"]')).reverse().find(a=>{if(a.getBoundingClientRect().width>0)return n=a,!0}),n){if(n.getAttribute("contenteditable")==="false")return!1;if(n.tagName==="TABLE")if(s)n=n.querySelector("th, td");else{const l=n.querySelectorAll("th, td");n=l[l.length-1]}let a;if(s)a=ce(n,S(n)),a.collapse(!0);else{let l=!1;if(e.getAttribute("data-type")==="NodeCodeBlock"){let r=n.lastChild;if(r||(n.innerHTML=`
`,r=n.lastChild),r.textContent===""&&r.nodeType===3&&(r=$(n.lastChild)),r&&r.textContent.endsWith(`
`)){if(r.nodeType===1)for(r=r.lastChild;r&&r.textContent.indexOf(`
`)===-1;)r=r.previousSibling;a=S(n),a.setStart(r,r.textContent.length-1),l=!0}}l||(a=x(n,S(n))),a.collapse(!1)}return N(a),a}else if(t)t.focus();else if(W(e))return I(e.querySelector("[data-node-id]"),t,s);return!1},fe=e=>{if(e.getAttribute("data-node-id")){let s,n;e.nextElementSibling&&!e.nextElementSibling.classList.contains("protyle-attr")?(n=!0,s=ue(e)):e.previousElementSibling&&(n=!1,s=oe(e)),s||(s=e),I(s,void 0,n);return}const t=S(e);e.nextSibling?(t.selectNodeContents(e.nextSibling),t.collapse(!0)):e.previousSibling&&(t.selectNodeContents(e.previousSibling),t.collapse(!1)),N(t)},he=(e,t=c.PROTYLE_CDN,s=1)=>{let n,a=!1;e.classList.contains("code-block")?n=e.querySelectorAll(".hljs"):e.classList.contains("item__readme")?(n=e.querySelectorAll("pre code"),n.forEach(l=>{l.parentElement.setAttribute("linenumber","false")})):e.classList.contains("b3-typography")?(n=e.querySelectorAll(".code-block code"),a=!0):n=e.querySelectorAll(".code-block .hljs"),n.length!==0&&(le(t),g(`${t}/js/highlight.js/highlight.min.js?v=11.11.1`,"protyleHljsScript").then(()=>{g(`${t}/js/highlight.js/third-languages.js?v=2.0.1`,"protyleHljsThirdScript").then(()=>{n.forEach(l=>{const r=l.parentElement.querySelectorAll(".protyle-icon");if(r.length===2&&(r[0].setAttribute("aria-label",window.siyuan.languages.copy),r[1].setAttribute("aria-label",window.siyuan.languages.more)),l.getAttribute("data-render")==="true")return;const o=l.querySelector("wbr");let u=0;if(o){let C=o.previousSibling;for(;C;){for(u+=C.textContent.length;!C.previousSibling&&C.parentElement.tagName!=="DIV";)C=C.parentElement;C=C.previousSibling}o.remove()}let d;a?d=l.parentElement.getAttribute("data-language"):l.previousElementSibling?d=l.previousElementSibling.firstElementChild.textContent:d=l.className.replace("language-",""),window.hljs.getLanguage(d)||(d="plaintext"),l.classList.add("hljs"),l.setAttribute("data-render","true");const p=l.parentElement.getAttribute("linewrap"),f=l.parentElement.getAttribute("ligatures"),R=l.parentElement.getAttribute("linenumber"),y=l.lastElementChild?l.lastElementChild:l;p==="true"||p!=="false"&&window.siyuan.config.editor.codeLineWrap?(y.style.setProperty("white-space","pre-wrap"),y.style.setProperty("word-break","break-word")):(y.style.setProperty("white-space","pre"),y.style.setProperty("word-break","initial")),f==="true"||f!=="false"&&window.siyuan.config.editor.codeLigatures?y.style.fontVariantLigatures="normal":y.style.fontVariantLigatures="none";const X=y.textContent;l.firstElementChild&&(!a&&(R==="true"||R!=="false"&&window.siyuan.config.editor.codeSyntaxHighlightLineNum)?(l.firstElementChild.className="protyle-linenumber__rows",l.firstElementChild.setAttribute("contenteditable","false"),pe(l,s),l.style.display=""):(l.firstElementChild.className="fn__none",l.firstElementChild.innerHTML="",y.style.paddingLeft="",l.style.display="block")),y.innerHTML=window.hljs.highlight(X+(X.endsWith(`
`)?"":`
`),{language:d,ignoreIllegals:!0}).value,o&&getSelection().rangeCount>0&&q(l,u,u)})})}))},pe=(e,t=1)=>{const s=e.parentElement.getAttribute("lineNumber");if(s==="false"||!window.siyuan.config.editor.codeSyntaxHighlightLineNum&&s!=="true")return;e.parentElement.style.lineHeight=`${((parseInt(e.parentElement.style.fontSize)||window.siyuan.config.editor.fontSize)*1.625*.85).toFixed(0)}px`;const n=e.lastElementChild,a=n.textContent.split(/\r\n|\r|\n|\u2028|\u2029/g);a[a.length-1]===""&&a.length>1&&a.pop(),e.firstElementChild.innerHTML=`<span>${a.length}</span>`,n.style.paddingLeft=`${e.firstElementChild.clientWidth+16}px`;let l="";if(n.style.wordBreak==="break-word"){const r=window.getComputedStyle(n),o=document.createElement("div");o.className="hljs",o.setAttribute("style",`padding-left:${n.style.paddingLeft};
width: ${n.getBoundingClientRect().width/t}px;
white-space:${r.whiteSpace};
word-break:${r.wordBreak};
font-variant-ligatures:${r.fontVariantLigatures};
padding-right:0;max-height: none;box-sizing: border-box;position: absolute;padding-top:0 !important;padding-bottom:0 !important;min-height:auto !important;`),o.setAttribute("contenteditable","true"),e.insertAdjacentElement("afterend",o),a.map(u=>{o.textContent=u.trim()?u:"<br>",l+=`<span style="height:${o.clientHeight}px"></span>`}),o.remove()}else l="<span></span>".repeat(a.length);if(e.firstElementChild.innerHTML=l,e.scrollHeight>e.clientHeight&&getSelection().rangeCount>0){const r=getSelection().getRangeAt(0);if(e.contains(r.startContainer)){const o=document.createElement("br");r.insertNode(o),o.scrollIntoView({block:"nearest"}),o.remove()}}},ge=(e,t=c.PROTYLE_CDN,s=!1)=>{let n=[];e.getAttribute("data-subtype")==="math"?n=[e]:n=Array.from(e.querySelectorAll('[data-subtype="math"]')),n.length!==0&&(P(`${t}/js/katex/katex.min.css?v=0.16.9`,"protyleKatexStyle"),g(`${t}/js/katex/katex.min.js?v=0.16.9`,"protyleKatexScript").then(()=>{g(`${t}/js/katex/mhchem.min.js?v=0.16.9`,"protyleKatexMhchemScript").then(()=>{n.forEach(a=>{var l,r;if(a.getAttribute("data-render")==="true")return;a.setAttribute("data-render","true");let o={};try{o=U(window.siyuan.config.editor.katexMacros||"{}")}catch(d){console.warn("KaTex macros is not JSON",d)}const u=a.tagName==="DIV";try{const d=window.katex.renderToString(Lute.UnEscapeHTMLStr(a.getAttribute("data-content")),{displayMode:u,output:"html",macros:o,trust:!0,strict:f=>f==="unicodeTextInMathMode"?"ignore":"warn"}),p=O(a);if(u){M(a),a.firstElementChild.firstElementChild.classList.remove("ft__error"),a.firstElementChild.firstElementChild.setAttribute("contenteditable","false"),a.firstElementChild.firstElementChild.innerHTML=d;const f=a.querySelectorAll(".base");f.length>0&&f[f.length-1].insertAdjacentHTML("afterend","<span class='fn__flex-1'></span>");const R=a.querySelector(".katex-html > .newline");R&&(R.parentElement.style.display="block")}else{a.classList.remove("ft__error"),a.innerHTML=d,p&&a.getBoundingClientRect().width>p.clientWidth?(a.style.maxWidth="100%",a.style.overflowX="auto",a.style.overflowY="hidden",a.style.display="inline-block"):(a.style.maxWidth="",a.style.overflowX="",a.style.overflowY="",a.style.display="");const f=Y(a);f?f&&f.nodeType!==3&&(((l=f.getAttribute("data-type"))==null?void 0:l.indexOf("inline-math"))>-1||f.classList.contains("img"))?a.after(document.createTextNode(c.ZWSP)):f&&!f.textContent.startsWith(`
`)&&f.textContent!==c.ZWSP&&a.insertAdjacentHTML("beforeend","&#xFEFF;"):a.parentElement.tagName!=="TH"&&a.parentElement.tagName!=="TD"?a.insertAdjacentText("afterend",`
`):a.insertAdjacentText("afterend",c.ZWSP),(r=a.previousSibling)!=null&&r.textContent.endsWith(`
`)?a.insertAdjacentText("beforebegin",c.ZWSP):!$(a)&&["TH","TD"].includes(a.parentElement.tagName)&&a.insertAdjacentText("afterbegin",c.ZWSP)}s&&setTimeout(()=>{if(u){const f=a.querySelector(".katex-display");f.clientWidth<f.scrollWidth&&f.firstElementChild.setAttribute("style",`font-size:${f.clientWidth*100/f.scrollWidth}%`)}else p&&a.offsetWidth>p.clientWidth&&a.firstElementChild.setAttribute("style",`font-size:${p.clientWidth*100/a.offsetWidth}%`)})}catch(d){u?(M(a),a.firstElementChild.firstElementChild.setAttribute("contenteditable","false"),a.firstElementChild.firstElementChild.innerHTML=d.message,a.firstElementChild.firstElementChild.classList.add("ft__error")):(a.innerHTML=d.message,a.classList.add("ft__error"))}})})}))};var z=(e,t,s)=>new Promise((n,a)=>{var l=u=>{try{o(s.next(u))}catch(d){a(d)}},r=u=>{try{o(s.throw(u))}catch(d){a(d)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(l,r);o((s=s.apply(e,t)).next())});const be=(e,t=c.PROTYLE_CDN)=>{let s=[];e.getAttribute("data-subtype")==="mermaid"?s=[e]:s=Array.from(e.querySelectorAll('[data-subtype="mermaid"]')),s.length!==0&&g(`${t}/js/mermaid/mermaid.min.js?v=11.12.0`,"protyleMermaidScript").then(()=>{g(`${t}/js/mermaid/mermaid-zenuml.min.js?v=0.2.2`,"protyleMermaidZenumlScript").then(()=>z(void 0,null,function*(){yield window.mermaid.registerExternalDiagrams([window.zenuml]),window.mermaid.registerIconPacks([{name:"logos",loader:()=>fetch(`${t}/js/mermaid/icons.json?v=11.11.0`).then(r=>r.json())}]);const n={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};window.siyuan.config.appearance.mode===1&&(n.theme="dark"),window.mermaid.initialize(n);const a=[],l=[];if(s.forEach(r=>{r.firstElementChild.clientWidth===0?a.push(r):l.push(r)}),a.length>0){const r=new MutationObserver(()=>{K(a),r.disconnect()});a.forEach(o=>{const u=w(o,"fold","1");if(u)r.observe(u,{attributeFilter:["fold"]});else{const d=b(o,"card__block",!0);d&&r.observe(d,{attributeFilter:["class"]})}})}K(l)}))})},K=e=>{const t=b(e[0],"protyle-wysiwyg",!0);e.forEach(s=>z(void 0,null,function*(){if(s.getAttribute("data-render")==="true")return;s.firstElementChild.classList.contains("protyle-icons")||s.insertAdjacentHTML("afterbegin",T(t));const n=s.firstElementChild.nextElementSibling;if(!s.getAttribute("data-content")){n.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span>`;return}const a="mermaid"+Lute.NewNodeID();try{n.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div contenteditable="false"><span id="${a}"></span></div>`;const l=yield window.mermaid.render(a,Lute.UnEscapeHTMLStr(s.getAttribute("data-content")));n.lastElementChild.innerHTML=l.svg}catch(l){const r=document.querySelector("#"+a);n.lastElementChild.innerHTML=`${r.outerHTML}<div class="fn__hr"></div><div class="ft__error">${l.message.replace(/\n/,"<br>")}</div>`,r.parentElement.remove()}s.setAttribute("data-render","true")}))},me=(e,t=c.PROTYLE_CDN)=>{let s=[];e.getAttribute("data-subtype")==="flowchart"?s=[e]:s=Array.from(e.querySelectorAll('[data-subtype="flowchart"]')),s.length!==0&&g(`${t}/js/flowchart.js/flowchart.min.js?v=1.18.0`,"protyleFlowchartScript").then(()=>{if(s[0].firstElementChild.clientWidth===0){const n=new MutationObserver(()=>{V(s),n.disconnect()}),a=w(s[0],"fold","1");if(a)n.observe(a,{attributeFilter:["fold"]});else{const l=b(s[0],"card__block",!0);l&&n.observe(l,{attributeFilter:["class"]})}}else V(s)})},V=e=>{const t=b(e[0],"protyle-wysiwyg",!0);e.forEach(s=>{if(s.getAttribute("data-render")==="true")return;s.firstElementChild.classList.contains("protyle-icons")||s.insertAdjacentHTML("afterbegin",T(t));const n=s.firstElementChild.nextElementSibling;if(!s.getAttribute("data-content")){n.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span>`;return}try{n.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div contenteditable="false"></div>`,flowchart.parse(Lute.UnEscapeHTMLStr(s.getAttribute("data-content"))).drawSVG(n.lastElementChild)}catch(a){n.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div class="ft__error" contenteditable="false">Flow Chart render error: <br>${a}</div>`}s.setAttribute("data-render","true")})};var Ee=(e,t,s)=>new Promise((n,a)=>{var l=u=>{try{o(s.next(u))}catch(d){a(d)}},r=u=>{try{o(s.throw(u))}catch(d){a(d)}},o=u=>u.done?n(u.value):Promise.resolve(u.value).then(l,r);o((s=s.apply(e,t)).next())});const ye=(e,t=c.PROTYLE_CDN)=>{let s=[];e.getAttribute("data-subtype")==="echarts"?s=[e]:s=Array.from(e.querySelectorAll('[data-subtype="echarts"]')),s.length!==0&&s.length>0&&g(`${t}/js/echarts/echarts.min.js?v=5.3.2`,"protyleEchartsScript").then(()=>{g(`${t}/js/echarts/echarts-gl.min.js?v=2.0.9`,"protyleEchartsGLScript").then(()=>{const n=b(e,"protyle-wysiwyg",!0);let a;n&&n.clientWidth>0&&s[0].firstElementChild.clientWidth===0&&n.firstElementChild&&(a=n.firstElementChild.clientWidth),s.forEach(l=>Ee(void 0,null,function*(){var r,o,u;if(l.getAttribute("data-render")==="true")return;l.firstElementChild.classList.contains("protyle-icons")||l.insertAdjacentHTML("afterbegin",T(n,["refresh","edit","more"]));const d=l.firstElementChild.nextElementSibling;if(!l.getAttribute("data-content")){d.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span>`;return}try{!d.lastElementChild||d.childElementCount===1?d.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div style="height:${l.style.height||"420px"}" contenteditable="false"></div>`:d.lastElementChild.classList.remove("ft__error");const p=window.echarts.getInstanceById((r=d.lastElementChild)==null?void 0:r.getAttribute("_echarts_instance_")),f=yield U(Lute.UnEscapeHTMLStr(l.getAttribute("data-content")));p&&(((o=p.getOption().series[0])==null?void 0:o.type)!==((u=f.series[0])==null?void 0:u.type)&&p.clear(),p==null||p.resize()),window.echarts.init(d.lastElementChild,window.siyuan.config.appearance.mode===1?"dark":void 0,{width:a}).setOption(f)}catch(p){window.echarts.dispose(d.lastElementChild),d.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div class="ft__error" style="height:${l.style.height||"420px"}" contenteditable="false">echarts render error: <br>${p}</div>`}l.setAttribute("data-render","true")}))})})},Z="%%params",Ae=e=>{let t={responsive:"resize"};const s=e.substring(0,e.indexOf(`
`));if(s.startsWith(Z))try{t=U(s.substring(Z.length))}catch(n){console.error(`Failed to parse ABCJS params: ${n}`)}return t},_e=(e,t=c.PROTYLE_CDN)=>{let s=[];e.getAttribute("data-subtype")==="abc"?s=[e]:s=Array.from(e.querySelectorAll('[data-subtype="abc"]')),s.length!==0&&s.length>0&&g(`${t}/js/abcjs/abcjs-basic-min.js?v=6.5.0`,"protyleAbcjsScript").then(()=>{const n=b(e,"protyle-wysiwyg",!0);s.forEach(a=>{if(a.getAttribute("data-render")==="true")return;a.firstElementChild.classList.contains("protyle-icons")||a.insertAdjacentHTML("afterbegin",T(n));const l=a.firstElementChild.nextElementSibling;l.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div contenteditable="false"></div>`;const r=Lute.UnEscapeHTMLStr(a.getAttribute("data-content"));window.ABCJS.renderAbc(l.lastElementChild,r,Ae(r)),a.setAttribute("data-render","true")})})},Ce=e=>{let t=[];e.getAttribute("data-type")==="NodeHTMLBlock"?t=[e]:t=Array.from(e.querySelectorAll('[data-type="NodeHTMLBlock"]')),t.length!==0&&t.length>0&&t.forEach(s=>{s.firstElementChild.firstElementChild.setAttribute("aria-label",window.siyuan.languages.edit),s.firstElementChild.lastElementChild.setAttribute("aria-label",window.siyuan.languages.more)})},Te=(e,t=c.PROTYLE_CDN)=>{let s=[];e.getAttribute("data-subtype")==="mindmap"?s=[e]:s=Array.from(e.querySelectorAll('[data-subtype="mindmap"]')),s.length!==0&&g(`${t}/js/echarts/echarts.min.js?v=0.0.0`,"protyleEchartsScript").then(()=>{const n=b(e,"protyle-wysiwyg",!0);let a;n&&n.clientWidth>0&&s[0].firstElementChild.clientWidth===0&&n.firstElementChild&&(a=n.firstElementChild.clientWidth),s.forEach(l=>{if(l.getAttribute("data-render")==="true")return;l.firstElementChild.classList.contains("protyle-icons")||l.insertAdjacentHTML("afterbegin",T(n));const r=l.firstElementChild.nextElementSibling;if(!l.getAttribute("data-content")){r.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span>`;return}try{!r.lastElementChild||r.childElementCount===1?r.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div style="height:${l.style.height||"420px"}" contenteditable="false"></div>`:r.lastElementChild.classList.remove("ft__error"),window.echarts.init(r.lastElementChild,window.siyuan.config.appearance.mode===1?"dark":void 0,{width:a}).setOption({series:[{data:[JSON.parse(Lute.EChartsMindmapStr(Lute.UnEscapeHTMLStr(l.getAttribute("data-content"))))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:6,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:(o,u)=>{var d;return(d=u==null?void 0:u.data)!=null&&d.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"},backgroundColor:"transparent"})}catch(o){window.echarts.dispose(r.lastElementChild),r.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span><div class="ft__error" style="height:${l.style.height||"420px"}" contenteditable="false">Mindmap render error: <br>${o}</div>`}l.setAttribute("data-render","true")})})},Le=(e,t=c.PROTYLE_CDN)=>{let s=[];e.getAttribute("data-subtype")==="plantuml"?s=[e]:s=Array.from(e.querySelectorAll('[data-subtype="plantuml"]')),s.length!==0&&g(`${t}/js/plantuml/plantuml-encoder.min.js?v=0.0.0`,"protylePlantumlScript").then(()=>{const n=b(e,"protyle-wysiwyg",!0);s.forEach(a=>{if(a.getAttribute("data-render")==="true")return;a.firstElementChild.classList.contains("protyle-icons")||a.insertAdjacentHTML("afterbegin",T(n));const l=a.firstElementChild.nextElementSibling;if(!a.getAttribute("data-content")){l.innerHTML=`<span style="position: absolute;left:0;top:0;width: 1px;">${c.ZWSP}</span>`;return}try{const r=`${window.siyuan.config.editor.plantUMLServePath}${window.plantumlEncoder.encode(Lute.UnEscapeHTMLStr(a.getAttribute("data-content")))}`;l.innerHTML=`<object type="image/svg+xml" data="${r}"/>`,l.classList.remove("ft__error"),l.firstElementChild.addEventListener("error",()=>{l.innerHTML=`<img src=${r}">`})}catch(r){l.classList.add("ft__error"),l.innerHTML=`plantuml render error: <br>${r}`}a.setAttribute("data-render","true")})})};class m{}m.graphvizRender=re,m.highlightRender=he,m.mathRender=ge,m.mermaidRender=be,m.flowchartRender=me,m.chartRender=ye,m.abcRender=_e,m.mindmapRender=Te,m.plantumlRender=Le,m.htmlRender=Ce,window.Protyle=m;const Se=m;return E=E.default,E})())});we();})();
